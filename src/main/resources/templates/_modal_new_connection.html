 <!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"
xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf/layout">
 
<head>
</head>
 
<body>
	<div th:fragment="modal_new_connection">	 
	
		<script th:inline="javascript">
		$(function(){
			$("#alert_create_connection").hide()
			
	        $("#alert_create_connection_success").hide();
			
			$("#crate_connection_button").click(function(){
				//$('#history').html('<asset:image src="ajax-loading.gif"/>');
				$.ajax({
	                url : '/connection/create',
	                data : { host: $( "#host" ).val(),
	                		port: $("#port").val(),
	                		database: $("#database").val(),
	                		username: $("#username").val(),
	                		password: $("#password").val(),
	                		groupId: $("#groupId").val()} ,
	                type:"post",
	                dataType: 'json',
	                success : function(data) {			            	                	
	                	console.log(data);
	                	
	                	$("#alert_create_connection_success").show();
	                	setTimeout(function() {
	                		var form = $("#new-connection");
	                        form.modal('hide');
	                        form.find('input:text').val('');
	                        $("#alert_create_connection_success").hide();
	                    }, 1000);
	                	$("#select_server").append(new Option(data.result.description, data.result.key));
	                },
	                error: function(xhr){ 
	                    
	                    var json = xhr.responseJSON
	                    console.log( json );
	                    if ( json.fieldErrors != null ){
	                    	  
	                    	$("#alert_create_connection_msg").text(json.message);
	                    	$("#alert_create_connection_msg").append("<ul>");
	                    	
	                    	$.each( json.fieldErrors, function( key, value ) {
	                    		$("#alert_create_connection_msg").append( "<b>" + value.field + "</b>: " + value.message + "<br/>" );
	                    	});
	                    	$("#alert_create_connection_msg").append("</ul>");	                    	 
	                    	
	                		$("#alert_create_connection").show();
	                	}
	                }
	            })
			}); 
		});
			
		</script>	
		
		 
		 <div id="new-connection" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
		  <div class="modal-dialog modal-lg">
		    <div class="modal-content">
			     <div class="modal-header">
			        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
			        <h4 class="modal-title" id="myModalLabel">New connection</h4>
			      </div>
			      <div class="modal-body">
			        	 
		
					<div id="alert_create_connection_success" class="alert alert-success alert-dismissible" role="alert">
					  <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
					  
					  <div> Connection created with success! </div>
					</div>
					
					<div id="alert_create_connection" class="alert alert-danger alert-dismissible" role="alert">
					  <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
					  
					  <div id="alert_create_connection_msg">  </div>
					</div>
			
			        <form id="form_new_connection" class="form-horizontal" role="form"
			        	th:object="${connection}">
					  
					  <div class="form-group">
					    <label for="host" class="col-sm-2 control-label">Host *</label>
					    <div class="col-sm-10">
					      <input type="text" class="form-control" id="host" placeholder="localhost" th:field="*{host}"/>
					    </div>
					  </div>
					  
					  <div class="form-group">
					    <label for="port" class="col-sm-2 control-label">Port *</label>
					    <div class="col-sm-10">
					      <input type="text" class="form-control" id="port" placeholder="5432" th:field="*{port}"/>
					    </div>
					  </div>
					  
					  <div class="form-group">
					    <label for="database" class="col-sm-2 control-label">Database *</label>
					    <div class="col-sm-10">
					      <input type="text" class="form-control" id="database" placeholder="database" th:field="*{database}"/>
					    </div>
					  </div>
					  
					  <div class="form-group">
					    <label for="username" class="col-sm-2 control-label">Username *</label>
					    <div class="col-sm-10">
					      <input type="text" class="form-control" id="username" placeholder="postgres" th:field="*{username}"/>
					    </div>
					  </div>
					  
					  <div class="form-group">
					    <label for="password" class="col-sm-2 control-label">Password *</label>
					    <div class="col-sm-10">
					      <input type="password" class="form-control" id="password" placeholder="Password" th:field="*{password}"/>
					    </div>
					  </div>
					  
					  <div class="form-group">
					    <label for="alias" class="col-sm-2 control-label">Label</label>
					    <div class="col-sm-10">
					      <input type="text" class="form-control" id="alias" placeholder="Alias" th:field="*{label}"/>
					    </div>
					  </div>
					  
					  
					  <div class="form-group">
					    <label for="inputEmail3" class="col-sm-2 control-label">Server Group</label>
					    <div class="col-sm-10" >
				      	  <select id="groupId" class="form-control" th:each="serverGroup : ${serverGroups}" th:field="*{groupId}">
							  <option th:value="${serverGroup.id}" th:text="${serverGroup.name}">1</option>								  
							</select>
					    </div>
					  </div>
					  
				
					<div class="form-group">
					    <label for="inputEmail3" class="col-sm-2 control-label">Url Connection</label>
					    <div class="col-sm-10">
					      jdbc:postgresql://{host}:{port}/{database}
					    </div>
					  </div>
					  <div class="form-group">
					    
					  </div>
					</form>
					
			      </div>
			      <div class="modal-footer">
			        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
			        <button id="crate_connection_button" type="submit" class="btn btn-primary">Save changes</button>
			      </div>
			    
		    </div>
		  </div>
		</div>
	</div>
</body>
</html>